<!doctype html><html lang=en><head><title>Introduction to Stochastic Differential Equations</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.ffc4c7b40a84a6cc07476bf220dd79432177a593771276da69cb703d50fcac34.css integrity="sha256-/8THtAqEpswHR2vyIN15QyF3pZN3EnbaactwPVD8rDQ="><link rel=icon type=image/png href=/images/site/favicon_hu14458373468778497799.png><meta property="og:url" content="https://carlvinjerry.github.io/posts/quantitative-finance/intro-to-sdes/"><meta property="og:site_name" content="RΞCURSION"><meta property="og:title" content="Introduction to Stochastic Differential Equations"><meta property="og:description" content="Learn how stochastic differential equations (SDEs) model randomness in systems like stock prices prediction and renewable energy adoption, with practical F# examples using the Euler-Maruyama method."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-09T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:45:06+03:00"><meta property="article:tag" content="SDEs"><meta property="article:tag" content="Euler-Maruyama"><meta property="article:tag" content="F#"><meta property="article:tag" content="Renewable Energy"><meta property="article:tag" content="Financial Modeling"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introduction to Stochastic Differential Equations"><meta name=twitter:description content="Learn how stochastic differential equations (SDEs) model randomness in systems like stock prices prediction and renewable energy adoption, with practical F# examples using the Euler-Maruyama method."><meta name=description content="Learn how stochastic differential equations (SDEs) model randomness in systems like stock prices prediction and renewable energy adoption, with practical F# examples using the Euler-Maruyama method."><script async src="https://www.googletagmanager.com/gtag/js?id=462784605"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","462784605")}</script><script src=https://cdn.counter.dev/script.js data-id=CarlvinJerry data-utcoffset=1></script><script data-goatcounter=https://carlvinjerry.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu1754343916303502928.png id=logo alt=Logo>
RΞCURSION</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>Notes</a></li><li class=nav-item><a class=nav-link href=https://toha-guides.netlify.app/posts/>Docs</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu1754343916303502928.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu14458373468778497799.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a class=list-link href=/posts/introduction/ title=Introduction>Introduction</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/> Programming</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/code-sustainability/> Code Sustainability</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/code-sustainability/error-handling/> Error Handling</a><ul><li><a class=list-link href=/posts/programming/code-sustainability/error-handling/python-exceptions/ title="Exception Handling in Python">Exception Handling in Python</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/> Succint FSharp</a><ul><li><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/currying/ title="Currying and Partial Application">Currying and Partial Application</a></li><li><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/working-with-paket/ title="A Better Way to Manage Dependencies in F#">A Better Way to Manage Dependencies in F#</a></li><li><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/memoization/ title="Memoization in F#">Memoization in F#</a></li><li><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/pattern-matching/ title="Pattern Matching in F#">Pattern Matching in F#</a></li><li><a class=list-link href=/posts/programming/code-sustainability/succint-fsharp/fs-option-type/ title="Understanding the F# Option Type">Understanding the F# Option Type</a></li></ul></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/functional-programming/> Functional Programming</a><ul><li><a class=list-link href=/posts/programming/functional-programming/discriminated-unions/ title="Discriminated Unions in F#">Discriminated Unions in F#</a></li><li><a class=list-link href=/posts/programming/functional-programming/functional-programming/ title="Functional Programming Nuances">Functional Programming Nuances</a></li><li><a class=list-link href=/posts/programming/functional-programming/monads/ title="Functors and Monads in F#">Functors and Monads in F#</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/interoperability/> Interoperability</a><ul><li><a class=list-link href=/posts/programming/interoperability/rdotnet-interop/ title="R.NET Integration in .NET">R.NET Integration in .NET</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/languages/> Languages</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/programming/languages/fsharp/> fsharp</a><ul><li><a class=list-link href=/posts/programming/languages/fsharp/fsharp-9-review/ title=fsharp-9-review>fsharp-9-review</a></li></ul></li></ul></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/quantitative-finance/> Quantitative-Finance</a><ul class=active><li><a class="active list-link" href=/posts/quantitative-finance/intro-to-sdes/ title="Introduction to SDEs">Introduction to SDEs</a></li><li><a class=list-link href=/posts/quantitative-finance/portfolio-risk-attribution/ title="Portfolio Risk Attribution">Portfolio Risk Attribution</a></li><li><a class=list-link href=/posts/quantitative-finance/moving-averages/ title="Simple Moving Average">Simple Moving Average</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/quantitative-finance/intro-to-sdes/sdes.jpg)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/j5_hu8605642293593435631.jpg alt="Author Image"><h5 class=author-name>Carlvin Jerry Mwange</h5><p class=text-muted>Saturday, August 9, 2025 | 7 minutes</p></div><div class=title><h1>Introduction to Stochastic Differential Equations</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/sdes/ class="btn btn-sm btn-info">SDEs</a></li><li class=rounded><a href=/tags/euler-maruyama/ class="btn btn-sm btn-info">Euler-Maruyama</a></li><li class=rounded><a href=/tags/f#/ class="btn btn-sm btn-info">F#</a></li><li class=rounded><a href=/tags/renewable-energy/ class="btn btn-sm btn-info">Renewable Energy</a></li><li class=rounded><a href=/tags/financial-modeling/ class="btn btn-sm btn-info">Financial Modeling</a></li></ul></div><div class=post-content id=post-content><h1 id=introduction-to-stochastic-differential-equations-why-they-matter>Introduction to Stochastic Differential Equations: Why They Matter</h1><p>The innate randomness within time series data, especially in real-world modeling such as financial time series where we have volatile stock markets, or unpredictable climate patterns, is a major hindrance to accurate predictive modeling. <strong>Stochastic differential equations (SDEs)</strong> provide a mathematical framework to model such systems by coupling deterministic trends with random fluctuations in data. In their seminal book, <em>Numerical Solution of Stochastic Differential Equations</em>, Peter E. Kloeden and Eckhard Platen offer a comprehensive guide to solving SDEs numerically, making them accessible for applications in finance, physics, and Environmental, Social, and Governance (ESG) modeling. This post introduces SDEs and how to solve them numerically, then we demonstrate its use in modeling stock prices and renewable energy adoption, with simulations done in both F# and Python to bring the concepts to life.</p><h2 id=what-are-stochastic-differential-equations>What Are Stochastic Differential Equations?</h2><p>SDEs are differential equations that incorporate randomness, typically via <em><strong>Brownian motion</strong>—a mathematical model of random fluctuations</em>. Unlike deterministic differential equations (e.g., $$( \frac{dx}{dt} = rx )$$ for exponential growth), SDEs account for uncertainty. A general SDE is written as:</p><p>$$ dX_t = a(X_t, t) dt + b(X_t, t) dW_t $$</p><p>Here, $$( X_t )$$ is the system’s state at time $$( t )$$, $$( a(X_t, t) dt )$$ is the <strong>deterministic</strong> <em><strong>“drift”</strong></em> (predictable change), and $$( b(X_t, t) dW_t )$$ is the <strong>stochastic <em>“diffusion”</em></strong> (random change), driven by <strong>Brownian motion $$( W_t )$$</strong>. Since analytical solutions are often infeasible, numerical methods like those detailed in Kloeden and Platen’s book are essential for practical simulations.</p><p>SDEs are crucial for modeling systems where uncertainty is a key factor. This way we are able to introduce some sense of <strong>realism</strong> as the models capture random shocks (like market volatility or weather changes), and their numerical solutions enable simulations where the exact solutions are infeasible. They can therefore be broadly applied to different domains like in finance (option pricing), physics (particle motion), and biology (population dynamics). In ESG contexts, SDEs help quantify risks and opportunities, such as sustainable investments or renewable energy growth.</p><h2 id=the-euler-maruyama-method-a-simple-way-to-solve-sdes>The Euler-Maruyama Method: A Simple Way to Solve SDEs</h2><p>Solving SDEs numerically is often necessary, and the Euler-Maruyama method is one of the simplest and most widely used approaches. Think of it as an extension of the<a href=https://en.wikipedia.org/wiki/Euler_method target=_blank> Euler method for ordinary differential equations</a>, adapted to handle the random term in SDEs.</p><p>For an SDE like $$ dX_t = a(X_t, t) dt + b(X_t, t) dW_t $$, the Euler-Maruyama method approximates the solution over small time steps $$ \Delta t $$. Starting from an initial value $$ X_0 $$, it computes the next value $$ X_{t+\Delta t} $$ as:</p><p>$$ X_{t+\Delta t} = X_t + a(X_t, t) \Delta t + b(X_t, t) \Delta W_t $$</p><p>Here, $$ (\Delta W_t) $$ is a random increment drawn from a normal distribution with <strong>mean 0</strong> and <strong>variance $$ (\Delta t) $$</strong>, simulating <strong>Brownian motion</strong>. By repeating this over many time steps, we generate a path that approximates the SDE’s solution. The method is straightforward but may require small time steps for accuracy as larger steps can introduce errors (explored in later chapters of the book).</p><p>This method is ideal for beginners because it’s intuitive and easy to implement, yet powerful enough for real-world applications like stock price modeling or ESG scenarios. Let’s see it in action with two examples.</p><hr><h2 id=sdes-in-action>SDEs in Action</h2><p>With a basic understanding of SDEs, let&rsquo;s check out how we can actually use them to model time series data. We’ll apply the Euler-Maruyama method to the geometric Brownian motion (GBM) SDE:</p><p>$$ dS_t = \mu S_t dt + \sigma S_t dW_t $$</p><p>This models systems with proportional growth and volatility, perfect for stock prices and ESG applications like renewable energy adoption. We’ll use F# for simulations and <code>FSharp.Plotly</code> for visualizations.</p><h3 id=1-stock-price-simulation-single-path>1. Stock Price Simulation (Single Path)</h3><p>In finance, GBM models stock prices, where $$ (S_t) $$ is the price, $$ (\mu) $$ is the expected return, and $$ (\sigma) $$ is volatility. Below is F# code to simulate a single stock price path using Euler-Maruyama.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fsharp data-lang=fsharp><span style=display:flex><span><span style=color:#66d9ef>open</span> System
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define Random extension for Gaussian random numbers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Random</span> <span style=color:#66d9ef>with</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>member</span> this.<span style=color:#a6e22e>NextGaussian</span>() <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> u1 <span style=color:#f92672>=</span> this<span style=color:#f92672>.</span>NextDouble()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> u2 <span style=color:#f92672>=</span> this<span style=color:#f92672>.</span>NextDouble()
</span></span><span style=display:flex><span>        sqrt <span style=color:#f92672>(-</span>2<span style=color:#f92672>.</span>0 <span style=color:#f92672>*</span> log u1<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> cos <span style=color:#f92672>(</span>2<span style=color:#f92672>.</span>0 <span style=color:#f92672>*</span> Math.PI <span style=color:#f92672>*</span> u2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Euler-Maruyama for GBM (single path)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> eulerMaruyamaStock <span style=color:#f92672>(</span>mu<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>sigma<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>S0<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>T<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>N<span style=color:#f92672>:</span> int<span style=color:#f92672>)</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> dt <span style=color:#f92672>=</span> T <span style=color:#f92672>/</span> <span style=color:#66d9ef>float</span> N
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> rng <span style=color:#f92672>=</span> Random()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> sqrtDt <span style=color:#f92672>=</span> sqrt dt
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> times <span style=color:#f92672>=</span> <span style=color:#f92672>[</span>0<span style=color:#f92672>.</span>0 <span style=color:#f92672>..</span> dt <span style=color:#f92672>..</span> T<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> rec simulate <span style=color:#f92672>(</span>t<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>S<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>path<span style=color:#f92672>:</span> <span style=color:#66d9ef>float</span> <span style=color:#66d9ef>list</span><span style=color:#f92672>)</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> t <span style=color:#f92672>&gt;=</span> T <span style=color:#66d9ef>then</span> List.rev path
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> dW <span style=color:#f92672>=</span> sqrtDt <span style=color:#f92672>*</span> rng<span style=color:#f92672>.</span>NextGaussian()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> S_new <span style=color:#f92672>=</span> max 0<span style=color:#f92672>.</span>0 <span style=color:#f92672>(</span>S <span style=color:#f92672>+</span> mu <span style=color:#f92672>*</span> S <span style=color:#f92672>*</span> dt <span style=color:#f92672>+</span> sigma <span style=color:#f92672>*</span> S <span style=color:#f92672>*</span> dW<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            simulate <span style=color:#f92672>(</span>t <span style=color:#f92672>+</span> dt<span style=color:#f92672>)</span> S_new <span style=color:#f92672>(</span>S_new <span style=color:#f92672>::</span> path<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>times<span style=color:#f92672>,</span> simulate 0<span style=color:#f92672>.</span>0 S0 <span style=color:#f92672>[</span>S0<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Simulate stock price: mu = 0.1 (10% return), sigma = 0.2 (20% volatility), S0 = 100, T = 1 year, N = 100 steps
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#f92672>(</span>times<span style=color:#f92672>,</span> stockPath<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> eulerMaruyamaStock 0<span style=color:#f92672>.</span>1 0<span style=color:#f92672>.</span>2 100<span style=color:#f92672>.</span>0 1<span style=color:#f92672>.</span>0 100
</span></span><span style=display:flex><span>printfn <span style=color:#e6db74>&#34;Stock price path: %A&#34;</span> stockPath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Plot the stock price path
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> stockChart <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    Chart.Line<span style=color:#f92672>(</span>times<span style=color:#f92672>,</span> stockPath<span style=color:#f92672>,</span> Name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Stock Price Path ($)&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|&gt;</span> Chart.withXAxisStyle <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Time (Years)&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|&gt;</span> Chart.withYAxisStyle <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Stock Price ($)&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|&gt;</span> Chart.withTitle <span style=color:#e6db74>&#34;Simulated Stock Price Path&#34;</span>
</span></span><span style=display:flex><span>Chart.show stockChart
</span></span></code></pre></div><p>This simulates a stock price starting at Ksh. 100 with a 10% annual return and 20% volatility. The <code>max 0.0</code> ensures non-negative prices. The results are as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fsharp data-lang=fsharp><span style=display:flex><span>stock price path<span style=color:#f92672>:</span> <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>   100<span style=color:#f92672>.</span>0<span style=color:#f92672>,</span> 101<span style=color:#f92672>.</span>11301460741727<span style=color:#f92672>,</span> 101<span style=color:#f92672>.</span>10552216008797<span style=color:#f92672>,</span> 103<span style=color:#f92672>.</span>66038984679442<span style=color:#f92672>,</span> 99<span style=color:#f92672>.</span>60423208032427<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>   100<span style=color:#f92672>.</span>52153555846961<span style=color:#f92672>,</span> 104<span style=color:#f92672>.</span>28670352879755<span style=color:#f92672>,</span> 104<span style=color:#f92672>.</span>2411963925629<span style=color:#f92672>,</span> 107<span style=color:#f92672>.</span>81653555108797<span style=color:#f92672>,</span> 104<span style=color:#f92672>.</span>82101673954645<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>   107<span style=color:#f92672>.</span>97151860052547<span style=color:#f92672>,</span> 110<span style=color:#f92672>.</span>16060759513196<span style=color:#f92672>,</span> 107<span style=color:#f92672>.</span>23791032644421<span style=color:#f92672>,</span> 105<span style=color:#f92672>.</span>71024891598087<span style=color:#f92672>,</span> 108<span style=color:#f92672>.</span>27846467450969<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>   106<span style=color:#f92672>.</span>53674733609895<span style=color:#f92672>,</span> 106<span style=color:#f92672>.</span>37217900448393<span style=color:#f92672>,</span> 103<span style=color:#f92672>.</span>47916375576835<span style=color:#f92672>,</span> 104<span style=color:#f92672>.</span>24743895585692<span style=color:#f92672>,</span> 106<span style=color:#f92672>.</span>29036912629937<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>   106<span style=color:#f92672>.</span>26481380560035<span style=color:#f92672>,</span> 106<span style=color:#f92672>.</span>59640744591127<span style=color:#f92672>,</span> 108<span style=color:#f92672>.</span>48843510122286<span style=color:#f92672>,</span> 110<span style=color:#f92672>.</span>47151313733261<span style=color:#f92672>,</span> 109<span style=color:#f92672>.</span>21235109360083<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>   108<span style=color:#f92672>.</span>16943390269378<span style=color:#f92672>,</span> 107<span style=color:#f92672>.</span>63970939094808<span style=color:#f92672>,</span> <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><br><p>The <code>FSharp.Plotly</code> code generates an interactive line plot of the path as shown below:</p><br><p><img src=/posts/quantitative-finance/intro-to-sdes/stockpricepath.png></p><h3 id=2-esg-application-renewable-energy-adoption-multiple-paths>2. ESG Application: Renewable Energy Adoption (Multiple Paths)</h3><p>In ESG, GBM can model renewable energy adoption (e.g., installed capacity in gigawatts), where $$ (S_t) $$ is the capacity, $$ (\mu) $$ is the growth rate (policy or technology-driven), and $$ (\sigma) $$ is volatility (market or regulatory uncertainty). Below is Python code to simulate 100 paths and compute statistics.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Parameters</span>
</span></span><span style=display:flex><span>mu <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.05</span>      <span style=color:#75715e># Drift (5% growth)</span>
</span></span><span style=display:flex><span>sigma <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.15</span>   <span style=color:#75715e># Volatility (15%)</span>
</span></span><span style=display:flex><span>S0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>100.0</span>     <span style=color:#75715e># Initial capacity (GW)</span>
</span></span><span style=display:flex><span>T <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>        <span style=color:#75715e># Time horizon (1 year)</span>
</span></span><span style=display:flex><span>N <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>        <span style=color:#75715e># Number of time steps</span>
</span></span><span style=display:flex><span>num_paths <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>  <span style=color:#75715e># Number of paths</span>
</span></span><span style=display:flex><span>dt <span style=color:#f92672>=</span> T <span style=color:#f92672>/</span> N     <span style=color:#75715e># Time step size</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Time points (0 to 1 year, 101 points for N=100 steps)</span>
</span></span><span style=display:flex><span>times <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, N <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Euler-Maruyama for GBM (multiple paths)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>euler_maruyama_esg</span>(mu, sigma, S0, T, N, num_paths):
</span></span><span style=display:flex><span>    dt <span style=color:#f92672>=</span> T <span style=color:#f92672>/</span> N
</span></span><span style=display:flex><span>    sqrt_dt <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>sqrt(dt)
</span></span><span style=display:flex><span>    rng <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>default_rng()
</span></span><span style=display:flex><span>    paths <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(num_paths):
</span></span><span style=display:flex><span>        path <span style=color:#f92672>=</span> [S0]
</span></span><span style=display:flex><span>        S <span style=color:#f92672>=</span> S0
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(N):
</span></span><span style=display:flex><span>            dW <span style=color:#f92672>=</span> sqrt_dt <span style=color:#f92672>*</span> rng<span style=color:#f92672>.</span>normal()
</span></span><span style=display:flex><span>            S_new <span style=color:#f92672>=</span> max(<span style=color:#ae81ff>0.0</span>, S <span style=color:#f92672>+</span> mu <span style=color:#f92672>*</span> S <span style=color:#f92672>*</span> dt <span style=color:#f92672>+</span> sigma <span style=color:#f92672>*</span> S <span style=color:#f92672>*</span> dW)
</span></span><span style=display:flex><span>            path<span style=color:#f92672>.</span>append(S_new)
</span></span><span style=display:flex><span>            S <span style=color:#f92672>=</span> S_new
</span></span><span style=display:flex><span>        paths<span style=color:#f92672>.</span>append(path)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> times, paths
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate mean and standard deviation of final values</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>stats_final_values</span>(paths):
</span></span><span style=display:flex><span>    final_values <span style=color:#f92672>=</span> [path[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#66d9ef>for</span> path <span style=color:#f92672>in</span> paths]
</span></span><span style=display:flex><span>    mean <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean(final_values)
</span></span><span style=display:flex><span>    std_dev <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>std(final_values)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> mean, std_dev
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Simulate 100 paths</span>
</span></span><span style=display:flex><span>times, paths <span style=color:#f92672>=</span> euler_maruyama_esg(mu, sigma, S0, T, N, num_paths)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate statistics</span>
</span></span><span style=display:flex><span>mean_final, std_dev_final <span style=color:#f92672>=</span> stats_final_values(paths)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Print results</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Sample path:&#34;</span>, paths[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Mean final capacity: </span><span style=color:#e6db74>{</span>mean_final<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> GW, Std Dev: </span><span style=color:#e6db74>{</span>std_dev_final<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> GW&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot five sample paths</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>colors <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;blue&#39;</span>, <span style=color:#e6db74>&#39;red&#39;</span>, <span style=color:#e6db74>&#39;green&#39;</span>, <span style=color:#e6db74>&#39;orange&#39;</span>, <span style=color:#e6db74>&#39;purple&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(times, paths[i], label<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Path </span><span style=color:#e6db74>{</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>, color<span style=color:#f92672>=</span>colors[i])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;Simulated Energy Capacity (Gw)&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#34;Time (Years)&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#34;Capacity (GW)&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p>This simulates 100 paths of renewable energy capacity starting at 100 GW, with 5% growth and 15% volatility. The statistics (mean and standard deviation) quantify expected growth and uncertainty.</p><pre tabindex=0><code>Sample path: [100.0, np.float64(99.204485180959), np.float64(99.99447815591483), np.float64(98.39472934862667), np.float64(101.73235973308168), np.float64(100.18825614908017), np.float64(100.69041120131182), np.float64(101.1817296020377), np.float64(99.10457879727646), np.float64(100.62659955255305), np.float64(101.63562829880757), np.float64(101.54229485240586), np.float64(100.03065108502152), np.float64(100.11976172211635), np.float64(100.09426848131567), np.float64(101.03939760953821), np.float64(103.8064025910638), np.float64(104.83096431124694),...]
Mean final capacity: 105.69 GW, Std Dev: 15.33 GW
</code></pre><p>We can visualize five sample paths for clarity:</p><br><p><img src=/posts/quantitative-finance/intro-to-sdes/reneablepaths.png></p><br><p>The ESG example models renewable energy adoption, capturing uncertainties like policy changes or market shifts. The mean final capacity (e.g., ~105 GW) and standard deviation (e.g., ~15 GW) inform investment decisions for wind or solar projects, aligning with net-zero goals. Of course we can also use Monte Carlo methods to enhance these predictions by averaging multiple paths.</p><p>The stock price example applies to ESG-focused assets like green bonds. Simulating price paths helps assess risks (e.g., Value-at-Risk) for sustainable portfolios, ensuring compliance with governance standards.</p><h2 id=conclusion>Conclusion</h2><p>Stochastic differential equations are essential for modeling systems with randomness such stock prices or renewable energy adoption. The Euler-Maruyama method makes SDEs accessible, as shown in our F# simulations and plots for stock prices and renewable energy adoption. Run the code with <code>FSharp.Plotly</code> to explore these scenarios interactively. In our next post, we’ll dive into the Itô vs. Stratonovich debate, exploring how these frameworks shape SDE solutions and their applications.</p></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f&text=Introduction%20to%20Stochastic%20Differential%20Equations&via=R%ce%9eCURSION" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f&title=Introduction%20to%20Stochastic%20Differential%20Equations" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f&title=Introduction%20to%20Stochastic%20Differential%20Equations" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-mastodon" href="https://mastodon.social/share?text=Introduction%20to%20Stochastic%20Differential%20Equations - https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f" target=_blank><i class="fab fa-mastodon"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Introduction%20to%20Stochastic%20Differential%20Equations https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Introduction%20to%20Stochastic%20Differential%20Equations&body=https%3a%2f%2fcarlvinjerry.github.io%2fposts%2fquantitative-finance%2fintro-to-sdes%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/carlvinjerry/carlvinjerry.github.io/edit/main/content/posts/Quantitative-Finance/Intro%20to%20SDEs/index.markdown title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/programming/languages/fsharp/fsharp-9-review/ title="What’s New in F# 9 for Quant Developers" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>What’s New in F# 9 for Quant Developers</div></a></div><div class="col-md-6 next-article"><a href=/posts/quantitative-finance/portfolio-risk-attribution/ title="Attributing for Risk in Portfolio Management" class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Attributing for Risk in Portfolio Management</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="i_carlvin",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#what-are-stochastic-differential-equations>What Are Stochastic Differential Equations?</a></li><li><a href=#the-euler-maruyama-method-a-simple-way-to-solve-sdes>The Euler-Maruyama Method: A Simple Way to Solve SDEs</a></li><li><a href=#sdes-in-action>SDEs in Action</a><ul><li><a href=#1-stock-price-simulation-single-path>1. Stock Price Simulation (Single Path)</a></li><li><a href=#2-esg-application-renewable-energy-adoption-multiple-paths>2. ESG Application: Renewable Energy Adoption (Multiple Paths)</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://carlvinjerry.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://carlvinjerry.github.io/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://carlvinjerry.github.io/#projects>Projects</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:carlvinjerry@gmail.com%20%7c%20cmwange@beyondrawdata.co.ke target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>carlvinjerry@gmail.com | cmwange@beyondrawdata.co.ke</span></a></li><li><a href=https://github.com/carlvinjerry target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>carlvinjerry</span></a></li><li><a href=https://www.linkedin.com/in/carlvinmwange target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Carlvin Jerry Mwange</span></a></li><li><a href=tel:+254%20%280%29747%20942%20588 target=_blank rel=noopener><span><i class="fas fa-phone-alt"></i></span> <span>+254 (0)747 942 588</span></a></li><li><a href=https://www.researchgate.net/profile/carlvinmwange target=_blank rel=noopener><span><i class="fab fa-researchgate"></i></span> <span>Carlvin Jerry Mwange</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu16779671404603505019.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.b1192b27bb9da1367104dd2311a23a6f78cc8e16c840ce3f8406443569df5b65.js integrity="sha256-sRkrJ7udoTZxBN0jEaI6b3jMjhbIQM4/hAZENWnfW2U=" defer></script></body></html>